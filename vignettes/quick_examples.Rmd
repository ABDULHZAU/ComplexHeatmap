<!--
%\VignetteEngine{knitr}
%\VignetteIndexEntry{Quick Examples of Making Complex Heatmaps}
-->

Quick Examples of Making Complex Heatmaps
========================================

**Author**: Zuguang Gu ( z.gu@dkfz.de )

**Date**: `r Sys.Date()`

-------------------------------------------------------------

```{r global_settings, echo = FALSE, message = FALSE}
library(markdown)

library(knitr)
knitr::opts_chunk$set(
    error = FALSE,
    tidy  = FALSE,
    message = FALSE,
    fig.align = "center",
    fig.width = 5,
    fig.height = 5)
options(markdown.HTML.stylesheet = "custom.css")

options(width = 100)
```

*There will be more examples in this vignette.*

## Combine pvclust and heatmap

**pvclust** package provides a robust way to test the stability of the clustering
by random sampling from original data. Here you can organize the heatmap by the clustering
returned from `pvclust()`.

```{r}
library(ComplexHeatmap)

library(MASS)
library(pvclust)
data(Boston)
boston.pv <- pvclust(Boston, nboot=100)
plot(boston.pv)
```

Since by default `pvclust` clusters columns by 'correlation' method, we scale columns for
`Boston` data set to see the relative trend.

```{r}
Boston_scaled = apply(Boston, 2, scale)
Heatmap(Boston_scaled, cluster_columns = boston.pv$hclust, heatmap_legend_title = "Boston")
```

## Change styles of legend

By default, for both discrete and continuous colors, the legend is represented as a discrete color bar.
But continuous colors can also be set to continuous color bar. You can change the legend style both
for heatmap legend and simple annotation legend.

```{r}
library(circlize)
mat = matrix(rnorm(100), 10)
ha = HeatmapAnnotation(df = data.frame(value = runif(10)), 
	col = list(value = colorRamp2(c(0, 1), c("white", "red"))),
	color_bar = "continuous")
Heatmap(mat, heatmap_legend_title = "mat", heatmap_legend_color_bar = "continuous", 
	top_annotation = ha)
```

## Make a same plot as heatmap()

```{r}
heatmap(mat, col = topo.colors(50))
```

Compare to the native `heatmap()`, `Heatmap()` can give more accurate interpolation
for colors for continous values.

```{r}
Heatmap(mat, col = topo.colors(50), row_hclust_width = unit(2, "cm"), 
    column_hclust_height = unit(2, "cm"))
```
